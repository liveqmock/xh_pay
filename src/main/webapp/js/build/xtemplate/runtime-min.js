/*
Copyright 2013, KISSY UI Library v1.30
MIT Licensed
build time: Jan 17 15:57
*/
KISSY.add("xtemplate/runtime/base",function(f){function b(e,a){this.tpl=e;a=f.merge(g,a);a.subTpls=f.merge(a.subTpls,b.subTpls);a.commands=f.merge(a.commands,b.commands);this.option=a}var g={silent:!0,name:"",utils:{getProperty:function(e,a){if("this"==e)return a.length?[a[0]]:!1;var e=e.split("."),c=e.length,d,b,h,f,g,j=a.length;for(b=0;b<j;b++){h=a[b];g=1;for(d=0;d<c;d++){f=e[d];if("object"!=typeof h||!(f in h)){g=0;break}h=h[f]}if(g)return"function"==typeof h&&(h=h.call(a[j-1])),[h]}return!1}}};
b.prototype={constructor:b,removeSubTpl:function(e){delete this.option.subTpls[e]},removeCommand:function(e){delete this.option.commands[e]},addSubTpl:function(e,a){this.option.subTpls[e]=a},addCommand:function(e,a){this.option.commands[e]=a},render:function(e,a){a||(e=[e]);return this.tpl(e,this.option)}};return b});
KISSY.add("xtemplate/runtime/commands",function(f,b,g){var e=function(a,c){f[a.silent?"log":"error"](c)};return{each:function(a,c){var d=c.params;if(!d||1!=d.length)return e(c,"each must has one param"),"";var d=d[0],b="",h;if(d!==g){var f=[0,0].concat(a);h=d.length;for(var i=0;i<h;i++)f[0]=d[i],f[1]={xcount:h,xindex:i},b+=c.fn(f)}return b},"with":function(a,c){var d=c.params;if(!d||1!=d.length)return e(c,"with must has one param"),"";var d=d[0],b=[0].concat(a),f="";d!==g&&(b[0]=d,f=c.fn(b));return f},
"if":function(a,c){var d=c.params;if(!d||1!=d.length)return e(c,"if must has one param"),"";var b="";d[0]?b=c.fn(a):c.inverse&&(b=c.inverse(a));return b},set:function(a,c){for(var b=a.length-1;0<=b;b--)if("object"==typeof a[b]){f.mix(a[b],c.hash);break}return""},include:b.include}},{requires:["./include-command"]});
KISSY.add("xtemplate/runtime/include-command",function(f,b){var g={invokeEngine:function(e,a,c){return(new b(e,f.merge(c))).render(a,!0)},include:function(b,a){var c=a.params;if(!c||1!=c.length)return f[a.silent?"log":"error"]("include must has one param"),"";var c=c[0],d;if(!(d=a.subTpls[c]))return f[a.silent?"log":"error"]('does not include sub template "'+c+'"'),"";a.name=c;return g.invokeEngine(d,b,a)}};return g},{requires:["./base"]});
KISSY.add("xtemplate/runtime",function(f,b,g,e){b.addCommand=function(a,b){g[a]=b};b.removeCommand=function(a){delete g[a]};b.commands=g;b.includeCommand=e;var a={};b.subTpls=a;b.addSubTpl=function(b,d){a[b]=d};b.removeSubTpl=function(b){delete a[b]};return b.IncludeEngine=b},{requires:["./runtime/base","./runtime/commands","./runtime/include-command"]});
